import requests 

# å¤©æ°—ã‚³ãƒ¼ãƒ‰ã¨ã‚¢ã‚¤ã‚³ãƒ³ã®ãƒãƒƒãƒ”ãƒ³ã‚°
weather_icons = {
    "æ™´": "â˜€ï¸",
    "æ›‡": "â˜ï¸",
    "é›¨": "ğŸŒ§ï¸",
    "é›ª": "â„ï¸",
    "é›·": "âš¡",
    "éœ§": "ğŸŒ«ï¸"
}


# æ—¥æœ¬ã®47éƒ½é“åºœçœŒã¨citycodeã‚’è¨­å®š
city_code_list = {
    "åŒ—æµ·é“": "011000",
    "é’æ£®çœŒ": "020010",
    "å²©æ‰‹çœŒ": "030010",
    "å®®åŸçœŒ": "040010",
    "ç§‹ç”°çœŒ": "050010",
    "å±±å½¢çœŒ": "060010",
    "ç¦å³¶çœŒ": "070010",
    "èŒ¨åŸçœŒ": "080010",
    "æ ƒæœ¨çœŒ": "090010",
    "ç¾¤é¦¬çœŒ": "100010",
    "åŸ¼ç‰çœŒ": "110010",
    "åƒè‘‰çœŒ": "120010",
    "æ±äº¬éƒ½": "130010",
    "ç¥å¥ˆå·çœŒ": "140010",
    "æ–°æ½ŸçœŒ": "150010",
    "å¯Œå±±çœŒ": "160010",
    "çŸ³å·çœŒ": "170010",
    "ç¦äº•çœŒ": "180010",
    "å±±æ¢¨çœŒ": "190010",
    "é•·é‡çœŒ": "200010",
    "å²é˜œçœŒ": "210010",
    "é™å²¡çœŒ": "220010",
    "æ„›çŸ¥çœŒ": "230010",
    "ä¸‰é‡çœŒ": "240010",
    "æ»‹è³€çœŒ": "250010",
    "äº¬éƒ½åºœ": "260010",
    "å¤§é˜ªåºœ": "270010",
    "å…µåº«çœŒ": "280010",
    "å¥ˆè‰¯çœŒ": "290010",
    "å’Œæ­Œå±±çœŒ": "300010",
    "é³¥å–çœŒ": "310010",
    "å³¶æ ¹çœŒ": "320010",
    "å²¡å±±çœŒ": "330010",
    "åºƒå³¶çœŒ": "340010",
    "å±±å£çœŒ": "350010",
    "å¾³å³¶çœŒ": "360010",
    "é¦™å·çœŒ": "370010",
    "æ„›åª›çœŒ": "380010",
    "é«˜çŸ¥çœŒ": "390010",
    "ç¦å²¡çœŒ": "400010",
    "ä½è³€çœŒ": "410010",
    "é•·å´çœŒ": "420010",
    "ç†Šæœ¬çœŒ": "430010",
    "å¤§åˆ†çœŒ": "440010",
    "å®®å´çœŒ": "450010",
    "é¹¿å…å³¶çœŒ": "460010",
    "æ²–ç¸„çœŒ": "470010",
}

def weather_api(pref):
    city_code = city_code_list[pref]
    url = "https://weather.tsukumijima.net/api/forecast/city/" + city_code

    response = requests.get(url)
    weather_json = response.json()

    telop = weather_json['forecasts'][0]["telop"]
    max_temp = weather_json['forecasts'][0]["temperature"]["max"]["celsius"]
    min_temp = weather_json['forecasts'][0]["temperature"]["min"]["celsius"]
    if max_temp == None:
        max_temp = ""
    if min_temp == None:
        min_temp = ""
    return telop, max_temp, min_temp

def get_weather_icon(weather_text):
    """å¤©æ°—ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ã‚¢ã‚¤ã‚³ãƒ³ã‚’å–å¾—"""
    icon_list = []
    for key, icon in weather_icons.items():
        if key in weather_text:
            icon_list.append(icon)
    result = "".join(icon_list)
    return result  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³

